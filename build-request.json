{
  "kind": "build_request",
  "title": "Fix registerUser bug and ensure admin panel login works",
  "projectName": "NuroPay",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-15",
      "text": "Fix the `registerUser` backend function so that it no longer performs any admin role check or role assignment. Regular users must be able to register with mobile number, full name, 4-digit PIN, and device ID without receiving 'Unauthorized: Only admins can assign user roles' error. The function should simply create a new user record with a default user role and return a success result.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-recent"
        ],
        "quotes": [
          "Unauthorized: Only admins can assign user roles",
          "New registerUser update run"
        ]
      },
      "acceptanceCriteria": [
        "Submitting the registration form with valid full name, mobile number (01XXXXXXXXX), and 4-digit PIN creates the user account successfully without any error",
        "No admin role check is present in the registerUser function",
        "Newly registered users receive a default non-admin role",
        "The error message 'Unauthorized: Only admins can assign user roles' no longer appears during registration"
      ]
    },
    {
      "id": "REQ-16",
      "text": "Ensure the Admin Panel login at `/admin` works correctly with credentials `nuralom1` / `9040`. The admin login form must authenticate successfully with these credentials, store an admin session token in localStorage, and redirect to the admin dashboard. All admin dashboard tabs (Dashboard stats, Transaction Control, User Management, Transaction Management, Notifications, Support Tickets) must be accessible after login.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-recent"
        ],
        "quotes": [
          "admin panel login user setup run complete project"
        ]
      },
      "acceptanceCriteria": [
        "Navigating to /admin shows the admin login form",
        "Entering username 'nuralom1' and password '9040' and submitting redirects to the admin dashboard",
        "Incorrect credentials show an error message and do not grant access",
        "Admin session token is persisted in localStorage so the dashboard remains accessible on page reload",
        "All six admin dashboard sections are reachable after successful login"
      ]
    },
    {
      "id": "REQ-17",
      "text": "After fixing the registerUser bug, verify that the full user authentication flow works end-to-end: (1) A new user can register with mobile number, full name, and PIN; (2) The same user can then log in with their mobile number and PIN; (3) Device fingerprint is stored on first login; (4) Subsequent logins from the same device succeed without device mismatch errors.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-recent"
        ],
        "quotes": [
          "complete project"
        ]
      },
      "acceptanceCriteria": [
        "Registration completes without errors and returns a user ID",
        "Login with correct mobile + PIN returns user data and stores device fingerprint",
        "Subsequent login from the same device (same fingerprint) succeeds",
        "Login from a different device fingerprint shows the device mismatch error with support number +8809606945622",
        "After login, the user is redirected to the Home page"
      ]
    }
  ],
  "constraints": [
    "Do not change the admin credentials — username must remain 'nuralom1' and password '9040'",
    "Do not modify any files under frontend/src/hooks/ or frontend/src/components/ui/",
    "The registerUser fix must only remove the unauthorized role assignment check — do not alter other validation logic (mobile format, PIN length, duplicate mobile check)"
  ],
  "nonGoals": [
    "Adding new registration form fields beyond existing ones",
    "Changing the visual design of the login/registration or admin panel pages",
    "Implementing a new role/permission system",
    "Modifying any transaction, KYC, or notification logic"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}